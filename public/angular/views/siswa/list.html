<!-- Siswa List View -->

<!-- Page Header -->
<div class="page-header">
    <div class="page-title">
        <i class="fas fa-users"></i>
        <div class="page-title-text">
            <h2>{{ pageTitle }}</h2>
            <p>Daftar semua data siswa yang terdaftar dalam sistem</p>
        </div>
    </div>
    <div>
        <a href="#!/siswa/create" class="btn btn-primary">
            <i class="fas fa-plus"></i> Tambah Siswa Baru
        </a>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header text-white">
                <h5 class="mb-0">
                    <i class="fas fa-table"></i> Data Siswa
                </h5>
            </div>
            <div class="card-body">
                
                <!-- Filter Section -->
                <div class="filter-section mb-4" ng-if="!loading">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label class="form-label fw-bold">
                                <i class="fas fa-filter"></i> Filter Berdasarkan Kelas
                            </label>
                            <select class="form-select" ng-model="filter.kelas_id" ng-change="applyFilter()">
                                <option value="">-- Semua Kelas --</option>
                                <option ng-repeat="kelas in kelasList" value="{{ kelas.id }}">
                                    {{ kelas.kelas }}
                                </option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label fw-bold">
                                <i class="fas fa-filter"></i> Filter Berdasarkan Jurusan
                            </label>
                            <select class="form-select" ng-model="filter.jurusan_id" ng-change="applyFilter()">
                                <option value="">-- Semua Jurusan --</option>
                                <option ng-repeat="jurusan in jurusanList" value="{{ jurusan.id }}">
                                    {{ jurusan.jurusan }} - {{ jurusan.bidang }}
                                </option>
                            </select>
                        </div>
                        <div class="col-md-4 d-flex align-items-end">
                            <button class="btn btn-secondary w-100" ng-click="resetFilter()" ng-if="filter.kelas_id || filter.jurusan_id">
                                <i class="fas fa-redo"></i> Reset Filter
                            </button>
                            <div class="alert alert-info mb-0 w-100" ng-if="!filter.kelas_id && !filter.jurusan_id" style="padding: 10px;">
                                <small><i class="fas fa-info-circle"></i> Menampilkan semua data</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Loading State -->
                <div ng-if="loading" class="text-center py-5">
                    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-3 text-muted">Memuat data siswa...</p>
                </div>
                
                <!-- Data Table -->
                <div ng-if="!loading" class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead>
                            <tr>
                                <th width="5%">No</th>
                                <th>NIS</th>
                                <th>Nama Lengkap</th>
                                <th>Tempat Lahir</th>
                                <th>Tanggal Lahir</th>
                                <th>Jenis Kelamin</th>
                                <th>Kelas</th>
                                <th>Jurusan</th>
                                <th width="12%">Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="siswa in filteredSiswas">
                                <td>{{ $index + 1 }}</td>
                                <td><strong>{{ siswa.nis }}</strong></td>
                                <td>{{ siswa.nama }}</td>
                                <td>{{ siswa.tempat }}</td>
                                <td>{{ siswa.tgl_lahir | date:'dd/MM/yyyy' }}</td>
                                <td>
                                    <span class="badge" ng-class="siswa.jenis_kelamin === 'L' ? 'bg-info' : 'bg-pink'">
                                        <i class="fas" ng-class="siswa.jenis_kelamin === 'L' ? 'fa-mars' : 'fa-venus'"></i>
                                        {{ siswa.jenis_kelamin === 'L' ? 'Laki-laki' : 'Perempuan' }}
                                    </span>
                                </td>
                                <td>
                                    <span class="badge bg-success" ng-if="siswa.kelas">
                                        {{ siswa.kelas.kelas }}
                                    </span>
                                    <span class="text-muted" ng-if="!siswa.kelas">-</span>
                                </td>
                                <td>
                                    <span class="badge bg-warning" ng-if="siswa.jurusan">
                                        {{ siswa.jurusan.jurusan }}
                                    </span>
                                    <span class="text-muted" ng-if="!siswa.jurusan">-</span>
                                </td>
                                <td class="table-actions">
                                    <a href="#!/siswa/edit/{{ siswa.id }}" class="btn btn-sm btn-warning" title="Edit Data">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <button ng-click="deleteSiswa(siswa)" class="btn btn-sm btn-danger" title="Hapus Data">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr ng-if="filteredSiswas.length === 0 && siswas.length > 0">
                                <td colspan="9" class="text-center py-4">
                                    <div class="text-muted">
                                        <i class="fas fa-search fa-2x mb-3 d-block"></i>
                                        <p class="mb-0">Tidak ada data siswa yang sesuai dengan filter</p>
                                        <button class="btn btn-secondary btn-sm mt-3" ng-click="resetFilter()">
                                            <i class="fas fa-redo"></i> Reset Filter
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr ng-if="siswas.length === 0">
                                <td colspan="9" class="text-center py-4">
                                    <div class="text-muted">
                                        <i class="fas fa-info-circle fa-2x mb-3 d-block"></i>
                                        <p class="mb-0">Belum ada data siswa yang terdaftar</p>
                                        <a href="#!/siswa/create" class="btn btn-primary btn-sm mt-3">
                                            <i class="fas fa-plus"></i> Tambah Siswa Pertama
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Total Data -->
                <div ng-if="!loading && siswas.length > 0" class="mt-3">
                    <div class="alert alert-info border-0 mb-0" style="background: #E1F5FE;">
                        <i class="fas fa-info-circle" style="color: #0277BD;"></i>
                        <small style="color: #01579B;">
                            <span ng-if="!filter.kelas_id && !filter.jurusan_id">
                                Total: <strong>{{ siswas.length }}</strong> siswa terdaftar
                            </span>
                            <span ng-if="filter.kelas_id || filter.jurusan_id">
                                Menampilkan: <strong>{{ filteredSiswas.length }}</strong> dari <strong>{{ siswas.length }}</strong> siswa
                            </span>
                        </small>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</div>

<!-- Custom CSS -->
<style>
.filter-section {
    background: #F5F5F5;
    padding: 20px;
    border-radius: 10px;
    border: 1px solid #E0E0E0;
}

.filter-section .form-label {
    color: #546E7A;
    font-size: 13px;
    margin-bottom: 8px;
}

.filter-section .form-label i {
    color: #4FC3F7;
}
</style>

<!-- Custom CSS untuk badge pink -->
<style>
.bg-pink {
    background-color: #EC407A !important;
}
</style>
